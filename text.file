ğŸ—ï¸ Your Project Architecture & How It Works
Let me explain the complete architecture of your Lightweight LangChain-powered Bedrock Chat System and how all the components work together.
ğŸ“Š High-Level Architecture Overview
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚    â”‚                  â”‚    â”‚                 â”‚
â”‚   FRONTEND      â”‚â—„â”€â”€â–ºâ”‚   API GATEWAY    â”‚â—„â”€â”€â–ºâ”‚ AWS BEDROCK     â”‚
â”‚   (React)       â”‚    â”‚   (FastAPI)      â”‚    â”‚ (Claude Models) â”‚
â”‚   Port: 3000    â”‚    â”‚   Port: 8000     â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                        â”‚
         â”‚                        â–¼
         â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚              â”‚                  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   FILE SERVICE   â”‚
                        â”‚   (FastAPI)      â”‚
                        â”‚   Port: 7000     â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                                         â”‚
         â”‚      LIGHTWEIGHT LANGCHAIN Q&A         â”‚
         â”‚          SERVICE (FastAPI)              â”‚
         â”‚            Port: 6000                   â”‚
         â”‚                                         â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
         â”‚  â”‚ ChromaDB    â”‚  â”‚ SentenceTransf. â”‚  â”‚
         â”‚  â”‚ Vector      â”‚  â”‚ Embeddings      â”‚  â”‚
         â”‚  â”‚ Store       â”‚  â”‚ (MiniLM-L6-v2)  â”‚  â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                  â”‚
                    â”‚   MySQL DATABASE â”‚
                    â”‚   Port: 3306     â”‚
                    â”‚                  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ğŸ”„ Complete Data Flow: How Everything Works
1. Document Upload & Processing Flow
User uploads file â†’ Frontend â†’ API Gateway â†’ File Service â†’ Database
                                     â†“
              LangChain Q&A Service â† Background Processing â† File Service
                        â†“
              Text Splitting (RecursiveCharacterTextSplitter)
                        â†“
              Vector Embeddings (SentenceTransformers)
                        â†“
              Store in ChromaDB + MySQL chunks table
Step-by-Step:

User uploads PDF/TXT/DOCX file via React frontend
Frontend sends file to API Gateway (POST /upload)
API Gateway forwards to File Service for processing
File Service extracts text and stores file metadata in MySQL
Background Task triggers LangChain Q&A Service to process document
LangChain Service uses RecursiveCharacterTextSplitter to chunk text intelligently
SentenceTransformers creates vector embeddings for each chunk
ChromaDB stores vectors for similarity search
MySQL stores chunk text and metadata

2. Question & Answer Flow (LangChain RAG)
User asks question â†’ Frontend â†’ API Gateway â†’ LangChain Q&A Service
                                                      â†“
                              Vector Similarity Search (ChromaDB)
                                                      â†“
                              Retrieve relevant chunks
                                                      â†“
                              Build context with LangChain Documents
                                                      â†“
                              Send to AWS Bedrock (Claude) â†’ Generate Answer
                                                      â†“
                              Add citations & confidence score
                                                      â†“
                              Return to user via API Gateway â†’ Frontend
Step-by-Step:

User types question in frontend Q&A mode
Frontend sends question to API Gateway (POST /qa/ask)
API Gateway forwards to LangChain Q&A Service
LangChain Q&A performs vector similarity search in ChromaDB
ChromaDB returns most relevant document chunks based on embeddings
RAG Engine builds context using LangChain Document objects
Enhanced prompt sent to AWS Bedrock (Claude) with document context
Claude generates answer based on provided context
Citation system extracts sources and calculates confidence
Response includes answer, sources, confidence, and related questions

3. Traditional Chat Flow (Bedrock Only)
User message â†’ Frontend â†’ API Gateway â†’ Bedrock Service â†’ AWS Bedrock
                              â†“              â†“              â†“
                        Conversation    Add context    Generate response
                         history      from files           â†“
                              â†“              â†“              â†“
                        Store in â† API Gateway â† Bedrock Service
                         MySQL
ğŸ§© Component Details & Responsibilities
ğŸŒ Frontend (React - Port 3000)

Technology: React with modern hooks
Responsibilities:

User interface for chat and file upload
Q&A mode toggle (LangChain vs traditional chat)
Real-time processing status updates
Analytics dashboard
Session management


Key Features:

Drag & drop file upload
Conversation history display
Source citations display
Related questions suggestions



ğŸšª API Gateway (FastAPI - Port 8000)

Technology: FastAPI with async support
Responsibilities:

Route requests to appropriate services
Handle file uploads and processing coordination
Manage conversation storage
Provide unified API interface
Error handling and fallbacks


Key Endpoints:

POST /chat - Main chat endpoint with Q&A routing
POST /upload - File upload with background processing
GET /analytics/{session_id} - Session analytics
GET /services/status - Health monitoring



ğŸ“ File Service (FastAPI - Port 7000)

Technology: FastAPI with file processing libraries
Responsibilities:

Handle file uploads (PDF, TXT, DOCX, CSV, JSON, MD)
Extract text content from various formats
Store file metadata in MySQL
Trigger background document processing


Libraries Used:

PyPDF2 for PDF processing
python-docx for Word documents
Built-in CSV/JSON parsers



ğŸ§  LangChain Q&A Service (FastAPI - Port 6000) - CORE AI

Technology: FastAPI + LangChain + ChromaDB + SentenceTransformers
Responsibilities:

Document Processing: Intelligent text chunking with LangChain
Vector Storage: Create and manage embeddings with ChromaDB
RAG Implementation: Retrieval-Augmented Generation
Question Answering: Vector similarity search + context building
Citation Generation: Track sources and calculate confidence


LangChain Components:

RecursiveCharacterTextSplitter - Smart text chunking
ChromaDB - Vector database for similarity search
SentenceTransformers - Lightweight embedding model (all-MiniLM-L6-v2)
Document objects - Structured document representation



ğŸ¤– Bedrock Service (Go - Port 9000)

Technology: Go with AWS SDK
Responsibilities:

Interface with AWS Bedrock API
Handle multiple Claude model versions
Manage API authentication and rate limiting
Provide fallback between model versions


Supported Models:

Claude 3.5 Sonnet (primary)
Claude 3 Sonnet/Haiku (fallback)
Automatic model availability testing



ğŸ—„ï¸ MySQL Database (Port 3306)

Technology: MySQL 8.0 with optimized configuration
Responsibilities:

Store conversation history
Store file metadata and processing status
Store document chunks and metadata
Store Q&A interactions and analytics
Session management


Key Tables:

conversations - Chat history with metadata
uploaded_files - File information and status
document_chunks - Text chunks with LangChain metadata
qa_interactions - Q&A sessions with confidence scores



ğŸ”„ RAG (Retrieval-Augmented Generation) Pipeline
Phase 1: Document Ingestion
Raw Document â†’ Text Extraction â†’ LangChain Text Splitting â†’ 
Chunk Optimization â†’ Vector Embedding â†’ ChromaDB Storage â†’ MySQL Metadata
Phase 2: Question Processing
User Question â†’ Vector Embedding â†’ ChromaDB Similarity Search â†’ 
Relevant Chunks Retrieval â†’ LangChain Document Assembly â†’ 
Context Building â†’ Bedrock API Call â†’ Answer Generation
Phase 3: Response Enhancement
Generated Answer â†’ Source Citation â†’ Confidence Calculation â†’ 
Related Questions â†’ Response Assembly â†’ User Delivery
